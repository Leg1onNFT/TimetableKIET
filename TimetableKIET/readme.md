# Расписание ХПЭТ

## Файловая структура:

- *css* ( все стили )
	- global.css

- *dump* ( всё, что связанно с базой данных )
	- dump.sql ( дамп для MySQL )

- *img* ( изображения )

- *js* ( все js-скрипты )
	- *ajax* ( клиентская часть ajax-запросов )
		- ajax_cons.js
		- ajax_group.js
		- ajax_prepods.js

	- *libs* ( библиотеки js )
		- jquery-3.4.1.min.js
		- jquery-ui.min.js

- *php* ( серверная часть )
	- *ajax* ( серверная часть ajax-запросов )
		- ajax_cons.php
		- ajax_group.php
		- ajax_prepods.php

	- *libs* ( библиотеки php )
		- features_week.php ( соотношение выделения с днём недели )
		- rb.php ( RedBean.php - удобная работа с базой данных MySQL )

	- *parts* ( вынесенные части сайта )
		- aside.php
		- footer.php
		- header.php
		- timing.php ( расписание звонков )

	- DB.php ( объявление связи с базой данных )

- cons.php ( расписание консультаций )
- gen.php ( технические скрипты для генерации случайных данных, сейчас не используются )
- index.php ( главная страница )
- plan.php ( учебный план на год )
- rasp.php ( расписание )
- rasp_prepod.php ( расписание для преподователей )
- news.php ( список изменений )
- readme.md ( собственно этот файл )

## 2. Структура сайта:

Жёсткой структуры нет. С любой страницы можно попасть на любую.  

Для динамических фильтров используются ajax-запросы. Все они работают по следующей схеме:
	
1. Выбор пользователем нужного значения на странице и нажатие кнопки
2. Перехват этого значения скриптом и отправка на сервер
3. Получение значения и его использование как фильтра в sql запросе
4. Обработка запроса базой данных
5. Получение ответа базы данных и его преобразование в неоходимую форму
6. Отправка результата на клиент
7. Перехват ответа скриптом
8. Встраивание результат на страницу и отображение пользователю

## 3. Генерация сайта:

Для упрощения написания кода и его генерации одинаковые блоки на веб-страницах вынесены в отдельные файлы, которые можно подключить по мере необходимости.  

CSS по возможности следует методологии БЭМ и также разбит по блокам. Использование встроенного CSS сведено к необходимому минимуму.  

Сайт полностью генерируется PHP на серверной стороне. JS при генерации не используется. Скрипты JS выполняют лишь ajax-запросы к серверу.  

Все данные сайта полностью хранятся в базе данных. Единственные заранее указанные данные те, что не меняются со временем, например, расписание звонков.

## 4. Структура базы данных

**Таблица prepod**

Хранит данные о всех преподавателях техникума

| name     | type      |
|:---------|:----------|
| id       | increment |
| фамилия  |           |
| имя      |           |
| отчество |           |

---

**Таблица cons**

Хранит данные о всех консультациях, проводимых преподавателями

| name              | type      |
|:------------------|:----------|
| id                | increment |
| id преподавателя  |           |
| дата / время      |           |
| продолжительность |           |

---

**Таблица prepodpars**

Хранит связи между преподавателями и проводимыми ими предметами

| name             | type      |
|:-----------------|:----------|
| id               | increment |
| id преподавателя |           |
| id пары          |           |

---

**Таблица pars**

Хранит названия всех предметов в техникуме

| name              | type      |
|:------------------|:----------|
| id                | increment |
| название предмета |           |

---

**Таблица zamena**

Хранит в себе замены одних пар на другие

| name                 | type      |
|:---------------------|:----------|
| id                   | increment |
| id пары в расписании |           |
| id пары              |           |

---

**Таблица rasp**

Хранит основное расписание пар на неделю для всех групп и по всем предметам

| name        | type      |
|:------------|:----------|
| id          | increment |
| id группы   |           |
| номер пары  |           |
| день недели |           |
| id пары     |           |

---

**Таблица groups**

Хранит все группы техникума, их название и коды

| name     | type      |
|:---------|:----------|
| id       | increment |
| название |           |
| код      |           |

---

**Таблица otdelgroups**

Хранит связи между группами, и отделениями, в которых они состоят.

| name         | type      |
|:-------------|:----------|
| id           | increment |
| id отделения |           |
| id группы    |           |

---

**Таблица otdelenie**

Хранит все отделения техникума

| name               | type      |
|:-------------------|:----------|
| id                 | increment |
| название отделения |           |
